{% extends 'root/base.html' %}
{% load static %}

{% block title %} Register a new Supplier {% endblock %}

{% block maincontent %}

<div class="container-fluid">
    <div class="mep-form_wrapper">

        <div class="elements-space-between">
            <h3>Supplier Registration</h3>
            <div></div>
        </div>

        <ul class="sub-tabs">
            <li data-tab-target="#basic_data_tab" class="sub-tab active">
                <div class="sub-tab-link">
                    <i class="fas fa-info-circle"></i><span> Basic Data</span>
                </div>
            </li>
<!--            <li data-tab-target="#org_data_tab" class="sub-tab">-->
<!--                <div class="sub-tab-link">-->
<!--                    <i class="fas fa-sitemap"></i><span> Organizational Data</span>-->
<!--                </div>-->
<!--            </li>-->
<!--            <li data-tab-target="#buisness_doc_tab" class="sub-tab">-->
<!--                <div class="sub-tab-link">-->
<!--                    <i class="fas fa-file-alt"></i><span> Business Document</span>-->
<!--                </div>-->
<!--            </li>-->
        </ul>

        <div class="tab-content">
            <div id="basic_data_tab" data-tab-content class="active">
                <div class="mt-3">

                </div>
            </div>

<!--            <div id="org_data_tab" data-tab-content>-->
<!--                <div class="mt-3">-->

<!--                </div>-->
<!--            </div>-->

<!--            <div id="buisness_doc_tab" data-tab-content>-->
<!--                <div class="mt-3">-->

<!--                </div>-->
<!--            </div>-->
        </div>

        <div class="card card-margin">

            <div class="card-header">
                <ul class="nav nav-tabs card-header-tabs">
                    <li class="nav-item">
                        <a class="nav-link active" data-toggle="tab" href="#basic_data_tab">Basic Data</a>
                    </li>
<!--                    <li class="nav-item">-->
<!--                        <a class="nav-link" data-toggle="tab" href="#org_data_tab">Organizational data</a>-->
<!--                    </li>-->
<!--                    <li class="nav-item">-->
<!--                        <a class="nav-link" data-toggle="tab" href="#buisness_doc_tab">Business Document</a>-->
<!--                    </li>-->
                </ul>
            </div>
                
            <div class="tab-content">

                <div id="basic_data_tab" class="tab-pane active p-3" >

                    <!-- Display the success message upon successful registration-->
                    <div>
                        {% if messages %}
                        <div class="alert alert-success">
                            {% for message in messages %}
                            <div class="{{ message.tags }}">{{ message }}</div>
                            {% endfor %}
                        </div>
                        {% endif %}
                    </div>

                    <form method="POST" id="configform">
                        {% csrf_token %}
                        
                        <!-- Display the eror messages during registration -->
                        {% if supplier_form.errors %}
                            <div class="alert alert-danger">
                                {% for field in supplier_form %} 
                                    {% if field.errors %}
                                    {{ field.label }}: {{ field.errors|striptags }} <br>
                                    {% endif %}
                                {% endfor %}
                            </div>
                        {% endif %}

                        <!--    Basic Data      -->
                        <div class="card">
                            <h5 class="card-header">Basic Data</h5>
                            <div class="card-body">
                                <div class="row">
                                    <div class="form-group col-md">
                                        <label> Supplier Id:</label><span class="hg_required"></span><br> 
                                        {{ supplier_form.supplier_id }}
                                    </div>
                                    <div class="form-group col-md">
                                        <label> Supplier Type:</label><span class="hg_required"></span><br>
                                        {{ supplier_form.supp_type }}
                                    </div>
                                    <div class="form-group col-md">
                                        <label> Registration Number</label><span class="hg_required"></span><br>
                                        {{ supplier_form.registration_number }}
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="form-group col-md">
                                        <label> Name 1:</label><span class="hg_required"></span><br>
                                        
                                        {{ supplier_form.name1 }}
                                    </div>
                                    <div class="form-group col-md">
                                        <label> Name 2:</label><br>
                                        
                                        {{ supplier_form.name2 }}
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="form-group col-md">
                                        <label> Currency:</label><span class="hg_required"></span><br>
                                        {{ supplier_form.currency_id }}
                                    </div>
                                    <div class="form-group col-md">
                                        <label> Language:</label><span class="hg_required"></span><br>
                                        {{ supplier_form.language_id }}
                                    </div>
                                    
                                    <div class="form-group col-md">
                                        <label> Country code:</label><span class="hg_required"></span><br>
                                        {{ supplier_form.country_code }}
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="form-group col-md">
                                        <label> City</label><span class="hg_required"></span><br>
                                        {{ supplier_form.city }}
                                    </div>
                                    <div class="form-group col-md">
                                        <label> Street:</label><br>
                                        {{ supplier_form.street }}
                                    </div>
                                    <div class="form-group col-md">
                                        <label> Postal code:</label><br>
                                        {{ supplier_form.postal_code }}
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="form-group col-md">
                                        <label> Upload Supplier Image:</label><br>
                                        {{ supplier_form.supplier_image }}
                                    </div>
                                </div>
                            </div>
                            
                        </div>
                        <br>

                        <!-- Contact information  -->
                        <div class="card">
                            <h5 class="card-header">Contact information</h5>
                            <div class="card-body">
                                <div class="row">
                                    <div class="form-group col-md">
                                        <label> E-mail:</label><span class="hg_required"></span><br>
                                        
                                        {{ supplier_form.email }}
                                    </div>
                                    <div class="form-group col-md">
                                        <label> Landline:</label><br>
                                        {{ supplier_form.landline }}
                                    </div>
                                    <div class="form-group col-md">
                                        <label> Mobile Number:</label><br>
                                        
                                        {{ supplier_form.mobile_num }}
                                    </div>
                                    <div class="form-group col-md">
                                        <label> Fax:</label><br>
                                        {{ supplier_form.fax }}
                                    </div>
                                </div>
                            </div>
                        </div>

                        <br>
                        <!-- Extended data -->
                        <div class="card">
                            <h5 class="card-header">Extended data</h5>
                            <div class="card-body">
                                <div class="row">
                                    <div class="form-group col-md">
                                        <label> Search Term 1:</label><br>
                                        {{ supplier_form.search_term1 }}
                                    </div>
                                    <div class="form-group col-md">
                                        <label> Search Term 2:</label><br>
                                        {{ supplier_form.search_term2 }}
                                    </div>
                                </div>    
                                <div class="row">
                                    <div class="form-group col-md">
                                        <label> Working days:</label><br>
                                        {{ supplier_form.delivery_days }}
                                    </div>
                                    <div class="form-group col-md">
                                        <label> Duns number:</label><br>
                                        {{ supplier_form.duns_number }}
                                    </div>
                                    <div class="form-group col-md">
                                        <label> Output Medium: </label>
                                        {{ supplier_form.output_medium }}
                                    </div>
                                </div>
                            </div>
                        </div>

                        <br>
                        <!-- Additional Contact -->
                        <div class="card">
                            <h5 class="card-header">Additional Contact</h5>
                            <div class="card-body">
                                <div class="row">

                                    <div class="form-group col-md">
                                        <label> E-mail 2:</label>
                                        {{ supplier_form.email2 }}
                                    </div>
                                    <div class="form-group col-md">
                                        <label> E-mail 3:</label>
                                        {{ supplier_form.email3 }}
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="form-group col-md-4">
                                        <label> E-mail 4:</label>
                                        {{ supplier_form.email4 }}
                                    </div>

                                    <div class="form-group col-md-4">
                                        <label> E-mail 5:</label>
                                        {{ supplier_form.email5 }}
                                    </div>
                                </div>
                            </div>
                        </div>
                        <br>
                        
                        <div class="d-flex justify-content-end">
                            <div>
                                <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#myModal">reset</button>
                                <!-- <button class="btn btn-primary" type="reset">Reset</button> -->
                                <button class="btn btn-primary" type="submit" title="Click here to Register" ><i class="fas fa-check"></i> register</button>
                            </div>
                        </div>
                        
                    </form>
                </div>

            
<!--                <div id="org_data_tab" class="tab-pane fade p-3">-->
<!--                    <div class="alert alert-success display-none" id="supplier_org_success" role="alert"></div>-->
<!--                    <div class="card">-->
<!--                        <h5 class="card-header">Organizational data</h5>-->
<!--                        <div class="card-body">-->
<!--                            <div class="mb-4">-->
<!--                                <button class="btn btn-primary" onclick="purch_org_add_new_line()">-->
<!--                                    <i class="fa fa-plus" aria-hidden="true" id="add_line" title="Add Line"></i> add</button>-->
<!--                                &lt;!&ndash;<button class="button" onclick="">&ndash;&gt;-->
<!--                                &lt;!&ndash;   <i class="fa fa-trash" aria-hidden="true" id="delete_line" title="Delete Line" ></i> Delete</button>&ndash;&gt;-->
<!--                                <button type="submit" class="btn btn-primary" onclick="save_supplier_org_details()"><i class="fas fa-save"></i> save</button>-->
<!--                            </div>-->
<!--                            <div>-->
<!--                                <table class="org_registration_table mb-4" id="supp_org_details" >-->
<!--                                    <thead>-->
<!--                                        <tr>-->
<!--                                            <th>Purchasing organisation </th>-->
<!--                                            <th>PO Currency</th>-->
<!--                                            <th>Payment Terms</th>-->
<!--                                            <th>Incoterm </th>-->
<!--                                            <th>GR based invoice verification</th>-->
<!--                                            <th>Invoice confirmation expected</th>-->
<!--                                            <th>GR confirmation expected</th>-->
<!--                                            <th>PO response</th>-->
<!--                                            <th>Shipping notification expected</th>-->
<!--                                            <th>Purchase block</th>-->
<!--                                        </tr>-->
<!--                                    </thead>-->
<!--                                    <tbody id="add_new_purch_org">-->
<!--                                        <tr>-->
<!--                                            <td>-->
<!--                                                <select class="form-control">-->
<!--                                                    <option selected="true" disabled>Select</option>-->
<!--                                                    {% for porg in purch_org%}-->
<!--                                                    <option>{{porg}}</option>-->
<!--                                                    {% endfor %}-->
<!--                                                </select>-->
<!--                                            </td>-->
<!--                                            <td>-->
<!--                                                <select class="form-control">-->
<!--                                                    <option selected="true" disabled>Select</option>-->
<!--                                                    {% for currency in currency_id%}-->
<!--                                                    <option>{{currency}}</option>-->
<!--                                                    {% endfor %}-->
<!--                                                </select>-->
<!--                                            </td>-->
<!--                                            <td>-->
<!--                                                <select class="form-control">-->
<!--                                                    <option selected="true" disabled>Select</option>-->
<!--                                                    {% for payterms in payterm_list %}-->
<!--                                                    <option>{{payterms}}</option>-->
<!--                                                    {% endfor %}-->
<!--                                                </select>-->
<!--                                            </td>-->
<!--                                            <td>-->
<!--                                                <select class="form-control">-->
<!--                                                    <option selected="true" disabled>Select</option>-->
<!--                                                    {% for incoterms in incoterm_list %}-->
<!--                                                    <option>{{incoterms}}</option>-->
<!--                                                    {% endfor %}-->
<!--                                                </select>-->
<!--                                            </td>-->
<!--                                            <td><input type="checkbox" name="gr_inv_vrf"></td>-->
<!--                                            <td><input type="checkbox" name="inv_conf_exp"></td>-->
<!--                                            <td><input type="checkbox" name="gr_conf_exp"></td>-->
<!--                                            <td><input type="checkbox" name="po_resp"></td>-->
<!--                                            <td><input type="checkbox" name="ship_notif_exp"></td>-->
<!--                                            <td><input type="checkbox" name="purch_block"></td>-->
<!--                                        </tr>-->
<!--                                    </tbody>-->
<!--                                </table>-->
<!--                            </div>-->

<!--                        </div>-->
<!--                    </div>-->
<!--                    -->
<!--                </div>-->


<!--                <div id="buisness_doc_tab" class="tab-pane fade p-3"><br>-->
<!--                    <h3>buisness document tab</h3>-->
<!--                    <p></p>-->
<!--                </div>-->
            </div>

        </div>
    </div>
    <div class="hg_spacer2"> &nbsp; </div>
    </div>

<div class="modal fade" id="myModal">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">

            <!-- Modal Header -->
            <div class="d-flex justify-content-end">
                <div>
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                </div>
            </div>
            
            <!-- Modal body -->
            <div class="modal-body">
                Are you sure you want to reset the form?
            </div>

            <!-- Modal footer -->
            <div class="modal-footer">
                <button type="button" class="btn btn-primary" data-dismiss="modal">no</button>
                <button type="button" class="btn btn-primary" id="supplier_form_reset">yes</button>
            </div>

        </div>
    </div>
</div> 

<script>

function purch_org_add_new_line() {
    var porg_list = {{purch_org|safe}}
    var porg_opt = ''
    for( let porg = 0; porg < porg_list.length; porg++ ) {
        porg_opt += '<option> '+ porg_list[porg] +' </option>'
    }

    var currency_list = {{currency_id|safe}}
    var currency_opt = ''
    for ( let curr=0; curr < currency_list.length; curr++ ){
        currency_opt += '<option> '+ currency_list[curr] +' </option>'
    }

    var payterm_list = {{payterm_list|safe}}
    var payterm_opt = ''
    for ( let payterm=0; payterm < payterm_list.length; payterm++ ){
        payterm_opt += '<option> '+ payterm_list[payterm] +' </option>'
    }

    var incoterm_list = {{incoterm_list|safe}}
    var incoterm_opt = ''
    for ( let incoterm=0; incoterm < incoterm_list.length; incoterm++ ){
        incoterm_opt += '<option> '+ incoterm_list[incoterm] +' </option>'
    }

    newOrgRow = '<tr> <td><select class="form-control" ><option selected="true" disabled="disabled"> Select </option>'+porg_opt+'</select></td> <td><select class="form-control" ><option selected="true" disabled="disabled"> Select </option>'+currency_opt+'</select></td> <td><select class="form-control" ><option selected="true" disabled="disabled"> Select </option>'+payterm_opt+'</select></td> <td><select class="form-control" ><option selected="true" disabled="disabled"> Select </option>'+incoterm_opt+'</select></td> <td><input type="checkbox"></td> <td><input type="checkbox"></td> <td><input type="checkbox"></td> <td><input type="checkbox"></td> <td><input type="checkbox"></td><td><input type="checkbox"></td></tr>'

    $("#add_new_purch_org").append(newOrgRow);
}

function ajax_save_supplier_org_details(data) {
    let urlLink = "{% url 'eProc_Suppliers:supplier_registration' %}"
    AjaxCallAPI(urlLink, data)
}
</script>

<script src="{% static 'scripts/supplier-register.js' %}"></script>
{% endblock %}

